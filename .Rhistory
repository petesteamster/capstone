plot(exp(rnorm(100)))
hist(rnorm(100))
hist(exp(rnorm(100)))
hist(sin(rnorm(100)))
t_mvnorm=mvrnorm(n = 1000,c(0,0,0,0,0), tListCorr[[3657]])#
tLM=lm((t_mvnorm[,1]*100)~x2+x3+x4+sin(round(x5*20)(),data=as.data.frame(t_mvnorm))#
tS=summary(tLM)
t_mvnorm=mvrnorm(n = 1000,c(0,0,0,0,0), tListCorr[[3657]])#
tLM=lm((t_mvnorm[,1]*100)~x2+x3+x4+sin(round(x5*20)),data=as.data.frame(t_mvnorm))#
tS=summary(tLM)
tS
hist(sin(round(x5*20)))
hist(sin(round(t_mvnorm[,5])))
(sin(round(t_mvnorm[,5])))
tLM=lm((t_mvnorm[,1]*100)~x2+x3+x4+sin(round(x5*20)),data=as.data.frame(t_mvnorm))#
tS=summary(tLM)
tS
t_mvnorm=mvrnorm(n = 1000,c(0,0,0,0,0), tListCorr[[3657]])#
tLM=lm((t_mvnorm[,1]*100)~x2+x3+x4+exp(round(x5*20)),data=as.data.frame(t_mvnorm))#
tS=summary(tLM)
tS
t_mvnorm=mvrnorm(n = 1000,c(0,0,0,0,0), tListCorr[[3657]])#
tLM=lm((t_mvnorm[,1]*100)~x2+x3+x4+(round(x5*20)),data=as.data.frame(t_mvnorm))#
tS=summary(tLM)
tS
t_mvnorm=mvrnorm(n = 1000,c(0,0,0,0,0), tListCorr[[3657]])#
tLM=lm((t_mvnorm[,1]*100)~x2+x3+x4+x5*20),data=as.data.frame(t_mvnorm))#
tS=summary(tLM)
tSrt=sort(tListRsq,index.return=TRUE,decreasing=T)#
t_mvnorm=mvrnorm(n = 1000,c(0,0,0,0,0), tListCorr[[3657]])#
tLM=lm((t_mvnorm[,1]*100)~x2+x3+x4+x5*20,data=as.data.frame(t_mvnorm))#
tS=summary(tLM)
tSrt=sort(tListRsq,index.return=TRUE,decreasing=T)#
t_mvnorm=mvrnorm(n = 1000,c(0,0,0,0,0), tListCorr[[3657]])#
tLM=lm((t_mvnorm[,1]*100)~x2+x3+x4+x5,data=as.data.frame(t_mvnorm))#
tS=summary(tLM)
tS
t_mvnorm=mvrnorm(n = 1000,c(0,0,0,0,0), tListCorr[[3657]])#
tLM=lm((t_mvnorm[,1]*100)~x2+x3+round(x4*20)+x5,data=as.data.frame(t_mvnorm))#
tS=summary(tLM)
tS
t_mvnorm=mvrnorm(n = 1000,c(0,0,0,0,0), tListCorr[[3657]])#
tLM=lm((t_mvnorm[,1]*100)~x2+x3+exp(round(x4*20))+x5,data=as.data.frame(t_mvnorm))#
tS=summary(tLM)
hist(exp(round(t_mvnorm[,4]*20)))
tSrt=sort(tListRsq,index.return=TRUE,decreasing=T)#
t_mvnorm=mvrnorm(n = 1000,c(0,0,0,0,0), tListCorr[[3657]])#
tLM=lm((t_mvnorm[,1]*100)~x2+x3+exp(round(x4))+x5,data=as.data.frame(t_mvnorm))#
tS=summary(tLM)
tS
hist(exp(round(t_mvnorm[,4])))
t_mvnorm=mvrnorm(n = 1000,c(0,0,0,0,0), tListCorr[[3657]])#
tLM=lm((t_mvnorm[,1]*100)~x2+x3+exp((x4))+x5,data=as.data.frame(t_mvnorm))#
tS=summary(tLM)
tS
hist(exp((t_mvnorm[,4])))
degree_count=3
seq=seq(from=3,to=(degree_count*3),by=2)
seq
400*200
400*203
1700*200
340000+80000
(340000+80000)*.68
t_mvnorm=mvrnorm(n = 1000,c(0,0,0,0,0), tListCorr[[3657]])#
tLM=lm((t_mvnorm[,1]*100)~x2+x3+sin((x4))+x5,data=as.data.frame(t_mvnorm))#
tS=summary(tLM)
tS
hist(sin(t_mvnorm[,4]))
seq(from=-1,to=1,by=.01)
plot(sin(seq(from=-1,to=1,by=.01))
plot(sin(seq(from=-1,to=1,by=.01)))
plot(sin(seq(from=-pi,to=pi,by=.01)))
plot(sin(seq(from=-pi/2,to=pi/2,by=.01)))
plot(sin(seq(from=-pi/2,to=0,by=.01)))
plot(sin(seq(from=-pi/2,to=pi,by=.01)))
plot(sin(seq(from=-pi/2,to=0,by=.01)))
plot(sin(seq(from=-pi/2,to=pi/2,by=.01)))
max(t_mvnorm[,4])
hist(t_mvnorm[,4]/max(t_mvnorm[,4]))
hist(t_mvnorm[,4]/max(abs(t_mvnorm[,4])))
hist(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+1)
hist(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+2)
hist(exp(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+2))
hist(sin(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+2))
hist(sin(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+pi))
hist(log(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+pi))
hist(log2(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+pi))
hist(sqrt(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+pi))
hist(sinh(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+pi))
hist(exp(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+pi))
hist(exp(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+5))
hist(exp(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+1))
hist(tanh(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+1))
plot(seq(from=-1,to=1,by=.01))
plot(sinh(seq(from=-1,to=1,by=.01)))
plot((seq(from=-1,to=1,by=.01)))
plot(sinh(seq(from=-1,to=1,by=.01)))
plot(tanh(seq(from=-1,to=1,by=.01)))
plot(tanh(seq(from=-1,to=1,by=.01))+1)
plot(log(seq(from=-1,to=1,by=.01))+1)
plot(log(seq(from=-1,to=1,by=.01)+1))
plot(sinh(seq(from=-1,to=1,by=.01)+1))
plot(tanh(seq(from=-1,to=1,by=.01)+1))
plot(cosh(seq(from=-1,to=1,by=.01)+1))
hist(tanh(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+1))
hist(tanh(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))))
hist(tanh(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+2))
hist(tanh(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+5))
hist(tanh(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+50))
hist(tanh(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+10))
hist(tanh(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+1))
hist(sinh(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+1))
hist(sinh(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+2))
hist(cosh(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+2))
hist(log(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+2))
hist(exp(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+2))
hist(sun(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+2))
hist(sin(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+2))
hist(cos(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+2))
hist(tan(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+2))
plot(tan(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+2))
plot(tan(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))))
hist(tan(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))))
plot(tanh(seq(from=-1,to=1,by=.01)+1))
plot(tan(seq(from=-1,to=1,by=.01)+1))
plot(t(cos(seq(from=-1,to=1,by=.01)+1))
)
plot(t(cos(seq(from=-1,to=1,by=.01)+1)))
plot((cos(seq(from=-1,to=1,by=.01)+1)))
plot(tan(seq(from=-1,to=1,by=.01)+1))
hist(tanh(t_mvnorm[,4]/max(abs(t_mvnorm[,4]))+5))
skew_left=function(tData,tConstant)#
{#
	tD=tanh(t_data[,4]/max(abs(t_data[,4]))+tConstant))#
	return (tD)#
}
skew_left=function(tData,tConstant)#
{#
	tD=tanh(t_data[,4]/max(abs(t_data[,4]))+tConstant)#
	return (tD)#
}
skew_left=function(tData,tConstant)#
{#
	tD=tanh(t_data[,4]/max(abs(t_data))+tConstant)#
	return (tD)#
}
hist(skew_left(t_mvnorm[,4])
hist(skew_left(t_mvnorm[,4]))
skew_left=function(t_data,tConstant)#
{#
	tD=tanh(t_data[,4]/max(abs(t_data))+tConstant)#
	return (tD)#
}
hist(skew_left(t_mvnorm[,4]))
skew_left=function(t_data,tConstant)#
{#
	tD=tanh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}
hist(skew_left(t_mvnorm[,4]))
hist(skew_left(t_mvnorm[,4]),1)
hist(skew_left(t_mvnorm[,4],1))
hist(skew_left(t_mvnorm[,4],2))
hist(skew_left(t_mvnorm[,4],0))
hist(skew_left(t_mvnorm[,4],.5))
skew_left=function(t_data,tConstant)#
{#
	tD=tanh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
skew_right=function(t_data,tConstant)#
{#
	tD=sinh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}
hist(skew_right(t_mvnorm[,4],.5))
hist(skew_right(t_mvnorm[,4],1))
hist(skew_right(t_mvnorm[,4],1.5))
bi_modal=function(t_data,tConstant)#
{#
	tD=sinh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}
bi_modal=function(t_data,tConstant)#
{#
	tD=sin(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}
hist(bi_modal(t_mvnorm[,4],1.5))
hist(bi_modal(t_mvnorm[,4],0))
bi_modal=function(t_data,t_factor)#
{#
	t_data=t_data/max(abs(t_data)*t_factor#
	tD=sin(t_data)#
	return (tD)#
}
bi_modal=function(t_data,t_factor)#
{#
	t_data=t_data/max(abs(t_data))*t_factor#
	tD=sin(t_data)#
	return (tD)#
}
hist(bi_modal(t_mvnorm[,4],0))
hist(bi_modal(t_mvnorm[,4],pi/2))
hist(bi_modal(t_mvnorm[,4],pi))
plot(sin(seq(from=-pi,to=pi,by=.01)))
plot(sin(seq(from=-pi/4,to=pi/4,by=.01)))
hist(skew_right(t_mvnorm[,4],1.5))
plot(sinh(seq(from=-pi,to=pi,by=.01)))
plot(tanh(seq(from=-pi,to=pi,by=.01)))
plot(sinh(seq(from=-pi,to=pi,by=.01)))
plot(cosh(seq(from=-pi,to=pi,by=.01)))
plot(cosh(seq(from=-10,to=10,by=.01)))
plot(sinh(seq(from=-10,to=10,by=.01)))
plot(sinh(seq(from=-1,to=1,by=.01)))
plot(sinh(seq(from=0,to=2,by=.01)))
plot(tanh(seq(from=0,to=2,by=.01)))
t_m=mvrnorm(n = 1000,c(0,0,0,0,0), tListCorr[[3657]])#
tLM=lm((x1~skew_right(x2,1)+skew_left(x3,2)+x4+x5,data=as.data.frame(t_m))#
tS=summary(tLM)
tLM=lm((x1~skew_right(x2,1)+skew_left(x3,2)+x4+x5,data=as.data.frame(t_m))
t_m
tLM=lm((x1~skew_left(x3,2)+x4+x5,data=as.data.frame(t_m))#
tS=summary(tLM)
tLM=lm((x1~x2+x3+x4+x5,data=as.data.frame(t_m))
lm((x1~x2+x3+x4+x5,data=as.data.frame(t_m))
t_m
as.data.frame(t_m)
names(as.data.frame(t_m))
tLM=lm((x1~x2+x3+x4+x5,data=data.frame(t_m))
t_data=data.frame(t_m)
tLM=lm(x1~x2+x3+x4+x5,data=t_data)
t_m=mvrnorm(n = 1000,c(0,0,0,0,0), tListCorr[[3657]])#
t_data=data.frame(t_m)#
tLM=lm(x1~x2+x3+x4+x5,data=t_data)#
tS=summary(tLM)
tS
t_m=mvrnorm(n = 1000,c(0,0,0,0,0), tListCorr[[3657]])#
t_data=data.frame(t_m)#
tLM=lm(x1~skew_right(x2,1)+x3+skew_left(x4,2)+x5,data=t_data)#
tS=summary(tLM)
tS
convert_counts=function(t_data,t_factor)#
{#
	tD=t_data/max(abs(t_data))#
	tD=tD+2#
	tD=tD*25#
	tD=round(tD)#
	return tD#
}
convert_counts=function(t_data,t_factor)#
{#
	tD=t_data/max(abs(t_data))#
	tD=tD+2#
	tD=tD*t_factor#
	tD=round(tD)#
	return tD#
}
tLM=lm(x1~skew_right(x2,1)+x3+skew_left(x4,2)+convert_counts(x5,30),data=t_data)#
tS=summary(tLM)
convert_counts=function(t_data,t_factor)#
{#
	tD=t_data/max(abs(t_data))#
	tD=tD+2#
	tD=tD*t_factor#
	tD=round(tD)#
	return tD#
}
convert_counts=function(t_data,t_factor)#
{#
	tD=t_data/max(abs(t_data))#
	tD=tD+2#
	tD=tD*t_factor#
	tD=round(tD)#
	return (tD)#
}
tLM=lm(x1~skew_right(x2,1)+x3+skew_left(x4,2)+convert_counts(x5,30),data=t_data)#
tS=summary(tLM)
tS
tSrt$x
tSrt$x[2000:3000]
tSrt$ix[3000]
t_m=mvrnorm(n = 1000,c(0,0,0,0,0), tListCorr[[16423]])#
t_data=data.frame(t_m)#
tLM=lm(x1~skew_right(x2,1)+x3+skew_left(x4,2)+convert_counts(x5,30),data=t_data)#
tS=summary(tLM)
tS
convert_counts(t_data[,5],25)
convert_counts(t_data[,5],5)
tLM=lm(x1~skew_right(x2,1)+x3+skew_left(x4,2)+convert_counts(x5,5),data=t_data)#
tS=summary(tLM)
tS
hist(convert_counts(t_data[,5],5))
tD=data.frame(t_data$x1,skew_right(t_data$x2,1),skew_left(t_data$x3),convert_counts(t_data$x5,5))
tD=data.frame(t_data$x1,skew_right(t_data$x2,1),skew_left(t_data$x3,2),convert_counts(t_data$x5,5))
tD[,5]
dim(tD)
tD=data.frame(t_data$x1,skew_right(t_data$x2,1),skew_left(t_data$x3,2),t_data$x4,convert_counts(t_data$x5,5))
tD[,5]
tD=data.frame(t_data$x1,skew_right(t_data$x2,1),skew_left(t_data$x3,2),t_data$x4,convert_counts(t_data$x5,5))#
amp_dt=ampute_data(tD,c(3,4),.2)
skew_left=function(t_data,tConstant)#
{#
	tD=tanh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
skew_right=function(t_data,tConstant)#
{#
	tD=sinh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
convert_counts=function(t_data,t_factor)#
{#
	tD=t_data/max(abs(t_data))#
	tD=tD+2#
	tD=tD*t_factor#
	tD=round(tD)#
	return (tD)#
}#
ampute_data<-function(tData,tCols,tProb)#
{#
	 tLen=length(tData[,1])#
	 tAmpData=tData#
	 tCount=round(tLen*tProb)#
	 for(i in tCols)#
	 {#
	 	 t_rows_set_null=sample(c(1:tLen),tCount, replace = FALSE)#
	 	 tAmpData[t_rows_set_null,i]<- NA #
	 }#
	 tR=list()#
	 tR[[1]]=tAmpData#
	 tR[[2]]=tData#
	 names(tR)=c("amp","data")#
	 return (tR)#
}
amp_dt=ampute_data(tD,c(3,4),.2)
amp_dt[,3]
amp_dt$amp[,3]
amp_dt=ampute_data(tD,c(3,4),.2)#
mi <- mice(amp_dt$amp)#
train <- complete(mi)
library(MASS)#
require(MASS)#
library(mice)
amp_dt=ampute_data(tD,c(3,4),.2)#
mi <- mice(amp_dt$amp)#
train <- complete(mi)
names(train)
names(train)=c('x1','x2','x3','x4','x5')
names(train)
tLM=lm(x1~x2+x3+x4+x5,data=train)#
summary(tLM)
t_m=mvrnorm(n = 1000,c(0,0,0,0,0), tListCorr[[16423]])#
t_data=data.frame(t_m)#
tLM=lm(x1~skew_right(x2,1)+x3+skew_left(x4,2)+convert_counts(x5,5),data=t_data)#
summary(tLM)#
tD=data.frame(t_data$x1,skew_right(t_data$x2,1),skew_left(t_data$x3,2),t_data$x4,convert_counts(t_data$x5,5))#
amp_dt=ampute_data(tD,c(2,3,4),.5)#
mi <- mice(amp_dt$amp)#
train <- complete(mi)#
names(train)=c('x1','x2','x3','x4','x5')#
tLM=lm(x1~x2+x3+x4+x5,data=train)#
summary(tLM)
tSrt[1:10]
tSrt$ix[1:10]
t_m=mvrnorm(n = 1000,c(0,0,0,0,0), tListCorr[[6077]])#
t_data=data.frame(t_m)#
tLM=lm(x1~skew_right(x2,1)+x3+skew_left(x4,2)+convert_counts(x5,5),data=t_data)#
summary(tLM)#
tD=data.frame(t_data$x1,skew_right(t_data$x2,1),skew_left(t_data$x3,2),t_data$x4,convert_counts(t_data$x5,5))#
amp_dt=ampute_data(tD,c(2,3,4),.5)#
mi <- mice(amp_dt$amp)#
train <- complete(mi)#
names(train)=c('x1','x2','x3','x4','x5')#
tLM=lm(x1~x2+x3+x4+x5,data=train)#
summary(tLM)
t_m=mvrnorm(n = 1000,c(0,0,0,0,0), tListCorr[[6077]])#
t_data=data.frame(t_m)#
tLM=lm(x1~skew_right(x2,1)+x3+skew_left(x4,2)+convert_counts(x5,5),data=t_data)#
summary(tLM)#
tD=data.frame(t_data$x1,skew_right(t_data$x2,1),skew_left(t_data$x3,2),t_data$x4,convert_counts(t_data$x5,5))#
amp_dt=ampute_data(tD,c(2,3,4),.7)#
mi <- mice(amp_dt$amp)#
train <- complete(mi)#
names(train)=c('x1','x2','x3','x4','x5')#
tLM=lm(x1~x2+x3+x4+x5,data=train)#
summary(tLM)
tSrt$ix[1:10]
tSrt$x[1:10]
t_m=mvrnorm(n = 1000,c(0,0,0,0,0), tListCorr[[3657]])#
t_data=data.frame(t_m)#
tLM=lm(x1~skew_right(x2,1)+x3+skew_left(x4,2)+convert_counts(x5,5),data=t_data)#
summary(tLM)#
tD=data.frame(t_data$x1,skew_right(t_data$x2,1),skew_left(t_data$x3,2),t_data$x4,convert_counts(t_data$x5,5))#
amp_dt=ampute_data(tD,c(2,3,4),.7)#
mi <- mice(amp_dt$amp)#
train <- complete(mi)#
names(train)=c('x1','x2','x3','x4','x5')#
tLM=lm(x1~x2+x3+x4+x5,data=train)#
summary(tLM)
t_m=mvrnorm(n = 1000,c(0,0,0,0,0), tListCorr[[3657]])#
t_data=data.frame(t_m)#
tLM=lm(x1~skew_right(x2,1)+x3+skew_left(x4,2)+convert_counts(x5,5),data=t_data)#
summary(tLM)#
tD=data.frame(t_data$x1,skew_right(t_data$x2,1),skew_left(t_data$x3,2),t_data$x4,convert_counts(t_data$x5,5))#
amp_dt=ampute_data(tD,c(2,3,4),.3)#
mi <- mice(amp_dt$amp)#
train <- complete(mi)#
names(train)=c('x1','x2','x3','x4','x5')#
tLM=lm(x1~x2+x3+x4+x5,data=train)#
summary(tLM)
library(MASS)#
require(MASS)#
library(mice)#
#
skew_left=function(t_data,tConstant)#
{#
	tD=tanh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
skew_right=function(t_data,tConstant)#
{#
	tD=sinh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
convert_counts=function(t_data,t_factor)#
{#
	tD=t_data/max(abs(t_data))#
	tD=tD+2#
	tD=tD*t_factor#
	tD=round(tD)#
	return (tD)#
}#
ampute_data<-function(tData,tCols,tProb)#
{#
	 tLen=length(tData[,1])#
	 tAmpData=tData#
	 tCount=round(tLen*tProb)#
	 for(i in tCols)#
	 {#
	 	 t_rows_set_null=sample(c(1:tLen),tCount, replace = FALSE)#
	 	 tAmpData[t_rows_set_null,i]<- NA #
	 }#
	 tR=list()#
	 tR[[1]]=tAmpData#
	 tR[[2]]=tData#
	 names(tR)=c("amp","data")#
	 return (tR)#
}#
#
d <- data.frame(x1=rnorm(10),#
                 x2=rnorm(10),#
                 x3=rnorm(10),#
                 x4=rnorm(10),#
                 x5=rnorm(10))#
#cor(d) #
tLM=lm(x1~x2+x3+x4+x5,data=d)#
tS=summary(tLM)#
tN=names(tS)#
tListRsq=vector()#
tListData=list()#
tListCorr=list()#
for(i in 1:2000)#
{#
	d <- data.frame(x1=rnorm(10),#
                 x2=rnorm(10),#
                 x3=rnorm(10),#
                 x4=rnorm(10),#
                 x5=rnorm(10))#
#
    tLM=lm(x1~x2+x3+x4+x5,data=d)#
    tS=summary(tLM)#
    tListRsq[i]=tS$r.squared#
    tListData[[i]]=d#
    tListCorr[[i]]=cor(d)#
}#
tSrt=sort(tListRsq,index.return=TRUE,decreasing=T)#
t_m=mvrnorm(n = 1000,c(0,0,0,0,0), tListCorr[[3657]])#
t_data=data.frame(t_m)#
tLM=lm(x1~skew_right(x2,1)+x3+skew_left(x4,2)+convert_counts(x5,5),data=t_data)#
summary(tLM)#
tD=data.frame(t_data$x1,skew_right(t_data$x2,1),skew_left(t_data$x3,2),t_data$x4,convert_counts(t_data$x5,5))#
amp_dt=ampute_data(tD,c(2,3,4),.3)#
mi <- mice(amp_dt$amp)#
train <- complete(mi)#
names(train)=c('x1','x2','x3','x4','x5')#
tLM=lm(x1~x2+x3+x4+x5,data=train)#
summary(tLM)
library(MASS)#
require(MASS)#
library(mice)#
#
skew_left=function(t_data,tConstant)#
{#
	tD=tanh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
skew_right=function(t_data,tConstant)#
{#
	tD=sinh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
convert_counts=function(t_data,t_factor)#
{#
	tD=t_data/max(abs(t_data))#
	tD=tD+2#
	tD=tD*t_factor#
	tD=round(tD)#
	return (tD)#
}#
ampute_data<-function(tData,tCols,tProb)#
{#
	 tLen=length(tData[,1])#
	 tAmpData=tData#
	 tCount=round(tLen*tProb)#
	 for(i in tCols)#
	 {#
	 	 t_rows_set_null=sample(c(1:tLen),tCount, replace = FALSE)#
	 	 tAmpData[t_rows_set_null,i]<- NA #
	 }#
	 tR=list()#
	 tR[[1]]=tAmpData#
	 tR[[2]]=tData#
	 names(tR)=c("amp","data")#
	 return (tR)#
}#
#
d <- data.frame(x1=rnorm(10),#
                 x2=rnorm(10),#
                 x3=rnorm(10),#
                 x4=rnorm(10),#
                 x5=rnorm(10))#
#cor(d) #
tLM=lm(x1~x2+x3+x4+x5,data=d)#
tS=summary(tLM)#
tN=names(tS)#
tListRsq=vector()#
tListData=list()#
tListCorr=list()#
for(i in 1:2000)#
{#
	d <- data.frame(x1=rnorm(10),#
                 x2=rnorm(10),#
                 x3=rnorm(10),#
                 x4=rnorm(10),#
                 x5=rnorm(10))#
#
    tLM=lm(x1~x2+x3+x4+x5,data=d)#
    tS=summary(tLM)#
    tListRsq[i]=tS$r.squared#
    tListData[[i]]=d#
    tListCorr[[i]]=cor(d)#
}#
tSrt=sort(tListRsq,index.return=TRUE,decreasing=T)#
tIndex=tSrt$ix#
t_m=mvrnorm(n = 1000,c(0,0,0,0,0), tListCorr[[tIndex]])#
t_data=data.frame(t_m)#
tLM=lm(x1~skew_right(x2,1)+x3+skew_left(x4,2)+convert_counts(x5,5),data=t_data)#
summary(tLM)#
tD=data.frame(t_data$x1,skew_right(t_data$x2,1),skew_left(t_data$x3,2),t_data$x4,convert_counts(t_data$x5,5))#
amp_dt=ampute_data(tD,c(2,3,4),.3)#
mi <- mice(amp_dt$amp)#
train <- complete(mi)#
names(train)=c('x1','x2','x3','x4','x5')#
tLM=lm(x1~x2+x3+x4+x5,data=train)#
summary(tLM)
tSrt=sort(tListRsq,index.return=TRUE,decreasing=T)#
tIndex=tSrt$ix[1]#
t_m=mvrnorm(n = 1000,c(0,0,0,0,0), tListCorr[[tIndex]])#
t_data=data.frame(t_m)#
tLM=lm(x1~skew_right(x2,1)+x3+skew_left(x4,2)+convert_counts(x5,5),data=t_data)#
summary(tLM)
tD=data.frame(t_data$x1,skew_right(t_data$x2,1),skew_left(t_data$x3,2),t_data$x4,convert_counts(t_data$x5,5))#
amp_dt=ampute_data(tD,c(2,3,4),.3)#
mi <- mice(amp_dt$amp)#
train <- complete(mi)#
names(train)=c('x1','x2','x3','x4','x5')#
tLM=lm(x1~x2+x3+x4+x5,data=train)#
summary(tLM)
is.na(amp_dt$amp)
t_na_indexes=which(is.na(amp_dt$amp))
t_na_indexes
hist(tD$x3[t_na_indexes])
tD$x3[t_na_indexes]
tD$x3[1]
tD$x3[2]
tD=data.frame(t_data$x1,skew_right(t_data$x2,1),skew_left(t_data$x3,2),t_data$x4,convert_counts(t_data$x5,5))#
names(tD)=c('x1','x2','x3','x4','x5')#
amp_dt=ampute_data(tD,c(2,3,4),.3)#
mi <- mice(amp_dt$amp)#
train <- complete(mi)#
names(train)=c('x1','x2','x3','x4','x5')#
tLM=lm(x1~x2+x3+x4+x5,data=train)#
summary(tLM)#
t_na_indexes=which(is.na(amp_dt$amp))#
hist(tD$x3[t_na_indexes])
tD$x3[t_na_indexes]
names(train)
hist(train$x3[t_na_indexes])
train$x3[t_na_indexes]
train
train$x3
train$x3[1]
train$x3[2]
is.na(train)
is.na(train$x3)
sum(is.na(train$x3))
dim(am-_dt)
dim(am-_dt$amp)
dim(amp_dt$amp)
t_na_indexes
t_na_indexes=which(is.na(amp_dt$amp$x3))#
hist(train$x3[t_na_indexes])
par(mfrow=c(2,2))#
hist(train$x3[t_na_indexes])#
hist(tD$x3)
t_na_indexes=which(is.na(amp_dt$amp$x4))#
par(mfrow=c(2,2))#
hist(train$x4[t_na_indexes])#
hist(tD$x4)
tSrt=sort(tListRsq,index.return=TRUE,decreasing=T)#
tIndex=tSrt$ix[1]#
t_m=mvrnorm(n = 1000,c(0,0,0,0,0), tListCorr[[tIndex]])#
t_data=data.frame(t_m)#
tLM=lm(x1~skew_right(x2,1)+x3+skew_left(x4,2)+convert_counts(x5,20),data=t_data)#
summary(tLM)#
tD=data.frame(t_data$x1,skew_right(t_data$x2,1),skew_left(t_data$x3,2),t_data$x4,convert_counts(t_data$x5,20))#
names(tD)=c('x1','x2','x3','x4','x5')#
amp_dt=ampute_data(tD,c(2,3,4),.3)#
mi <- mice(amp_dt$amp)#
train <- complete(mi)#
names(train)=c('x1','x2','x3','x4','x5')#
tLM=lm(x1~x2+x3+x4+x5,data=train)#
summary(tLM)#
t_na_indexes=which(is.na(amp_dt$amp$x4))#
par(mfrow=c(2,2))#
hist(train$x4[t_na_indexes])#
hist(tD$x4)
par(mfrow=c(2,2))#
hist(train$x2[t_na_indexes])#
hist(tD$x2)
tSrt=sort(tListRsq,index.return=TRUE,decreasing=T)#
tIndex=tSrt$ix[1]#
t_m=mvrnorm(n = 1000,c(0,0,0,0,0), tListCorr[[tIndex]])#
t_data=data.frame(t_m)#
tLM=lm(x1~skew_right(x2,3)+x3+skew_left(x4,2)+convert_counts(x5,20),data=t_data)#
summary(tLM)#
tD=data.frame(t_data$x1,skew_right(t_data$x2,3),skew_left(t_data$x3,2),t_data$x4,convert_counts(t_data$x5,20))#
names(tD)=c('x1','x2','x3','x4','x5')#
amp_dt=ampute_data(tD,c(2,3,4),.3)#
mi <- mice(amp_dt$amp)#
train <- complete(mi)#
names(train)=c('x1','x2','x3','x4','x5')#
tLM=lm(x1~x2+x3+x4+x5,data=train)#
summary(tLM)#
t_na_indexes=which(is.na(amp_dt$amp$x4))#
par(mfrow=c(2,2))#
hist(train$x2[t_na_indexes])#
hist(tD$x2)
setwd('/Users/peterstafford/generalassembly/capstone_repo/capstone/capstone')#
library(MASS)#
require(MASS)#
library(mice)#
#
skew_left=function(t_data,tConstant)#
{#
	tD=tanh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
skew_right=function(t_data,tConstant)#
{#
	tD=sinh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
convert_counts=function(t_data,t_factor,t_skew_left,t_skew)#
{#
	t_new_data=0;#
	if(t_skew_left==1)#
	{#
	 	t_new_data=skew_left(t_data,t_skew)#
	}#
	else #
	{#
	 	t_new_data=skew_right(t_data,t_skew)#
	}  #
	#tD=t_data/max(abs(t_data))#
	#tD=tD+2#
	tD=t_new_data#
	tD=tD*t_factor#
	tD=round(tD)#
	return (tD)#
}#
ampute_data<-function(tData,tCols,tProb)#
{#
	 tLen=length(tData[,1])#
	 tAmpData=tData#
	 tCount=round(tLen*tProb)#
	 for(i in tCols)#
	 {#
	 	 t_rows_set_null=sample(c(1:tLen),tCount, replace = FALSE)#
	 	 tAmpData[t_rows_set_null,i]<- NA #
	 }#
	 tR=list()#
	 tR[[1]]=tAmpData#
	 tR[[2]]=tData#
	 names(tR)=c("amp","data")#
	 return (tR)#
}#
get_threshold_r_square<-function(tData,t_thresh)#
{#
	t_indexes=which(tData<t_thresh)#
	t_vct1=tData[t_indexes]#
	tSrt=sort(tListRsq,index.return=TRUE,decreasing=T)#
	t_max_index=tSrt.ix[1]#
	t_max=tSrt.x[t_max_index]#
	return (t_max)#
}#
plot_dist=function(t_actual,t_imputed,t_imputed_indexes)#
{#
	t_cols=c('col_1','col_2','col_3','col_4','col_5')#
	par(mfrow=c(4,2))#
    for(i in 2:5)#
    {#
    	hist(t_imputed[t_imputed_indexes,i],xlab=t_cols[i],main='Imputed')#
        hist(t_actual[,i],xlab=t_cols[i],main='Actual')#
    }	 #
}#
#
d <- data.frame(x1=rnorm(10),#
                 x2=rnorm(10),#
                 x3=rnorm(10),#
                 x4=rnorm(10),#
                 x5=rnorm(10))#
#cor(d) #
tLM=lm(x1~x2+x3+x4+x5,data=d)#
tS=summary(tLM)#
tN=names(tS)#
tListRsq=vector()#
tListData=list()#
tListCorr=list()#
for(i in 1:2000)#
{#
	d <- data.frame(x1=rnorm(10),#
                 x2=rnorm(10),#
                 x3=rnorm(10),#
                 x4=rnorm(10),#
                 x5=rnorm(10))#
    tLM=lm(x1~x2+x3+x4+x5,data=d)#
    tS=summary(tLM)#
    tListRsq[i]=tS$r.squared#
    tListData[[i]]=d#
    tListCorr[[i]]=cor(d)#
}#
t_index=get_threshold_r_square(tListRsq,.8)#
t_m=mvrnorm(n = 2000,c(0,0,0,0,0), tListCorr[[t_index]])#
t_data=data.frame(t_m)#
tLM=lm(x1~skew_right(x2,3)+x3+skew_left(x4,2)+convert_counts(x5,20,0,5),data=t_data)#
summary(tLM)#
tD=data.frame(t_data$x1,skew_right(t_data$x2,3),skew_left(t_data$x3,2),t_data$x4,convert_counts(t_data$x5,40,0,5))#
names(tD)=c('x1','x2','x3','x4','x5')#
amp_dt=ampute_data(tD,c(2,3,4,5),.3)#
mi <- mice(amp_dt$amp)#
train <- complete(mi)#
names(train)=c('x1','x2','x3','x4','x5')#
tLM=lm(x1~x2+x3+x4+x5,data=train)#
summary(tLM)#
t_imputed_indexes=which(is.na(amp_dt$amp$x4))#
plot_dist(amp_dt$data,train,t_imputed_indexes)#
write.csv(amp_dt$amp,file='amp_data.csv',row.names=FALSE)#
write.csv(tD,file='sim_data.csv',row.names=FALSE)#
write.csv(train,file='imputed_r_30_percent_data.csv',row.names=FALSE)
setwd('/Users/peterstafford/generalassembly/capstone_repo/capstone/capstone')#
library(MASS)#
require(MASS)#
library(mice)#
#
skew_left=function(t_data,tConstant)#
{#
	tD=tanh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
skew_right=function(t_data,tConstant)#
{#
	tD=sinh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
convert_counts=function(t_data,t_factor,t_skew_left,t_skew)#
{#
	t_new_data=0;#
	if(t_skew_left==1)#
	{#
	 	t_new_data=skew_left(t_data,t_skew)#
	}#
	else #
	{#
	 	t_new_data=skew_right(t_data,t_skew)#
	}  #
	#tD=t_data/max(abs(t_data))#
	#tD=tD+2#
	tD=t_new_data#
	tD=tD*t_factor#
	tD=round(tD)#
	return (tD)#
}#
ampute_data<-function(tData,tCols,tProb)#
{#
	 tLen=length(tData[,1])#
	 tAmpData=tData#
	 tCount=round(tLen*tProb)#
	 for(i in tCols)#
	 {#
	 	 t_rows_set_null=sample(c(1:tLen),tCount, replace = FALSE)#
	 	 tAmpData[t_rows_set_null,i]<- NA #
	 }#
	 tR=list()#
	 tR[[1]]=tAmpData#
	 tR[[2]]=tData#
	 names(tR)=c("amp","data")#
	 return (tR)#
}#
get_threshold_r_square<-function(tData,t_thresh)#
{#
	t_indexes=which(tData<t_thresh)#
	t_vct1=tData[t_indexes]#
	tSrt=sort(tListRsq,index.return=TRUE,decreasing=T)#
	t_max_index=tSrt.ix[1]#
	t_max=tSrt.x[t_max_index]#
	return (t_max)#
}#
plot_dist=function(t_actual,t_imputed,t_imputed_indexes)#
{#
	t_cols=c('col_1','col_2','col_3','col_4','col_5')#
	par(mfrow=c(4,2))#
    for(i in 2:5)#
    {#
    	hist(t_imputed[t_imputed_indexes,i],xlab=t_cols[i],main='Imputed')#
        hist(t_actual[,i],xlab=t_cols[i],main='Actual')#
    }	 #
}#
#
d <- data.frame(x1=rnorm(10),#
                 x2=rnorm(10),#
                 x3=rnorm(10),#
                 x4=rnorm(10),#
                 x5=rnorm(10))#
#cor(d) #
tLM=lm(x1~x2+x3+x4+x5,data=d)#
tS=summary(tLM)#
tN=names(tS)#
tListRsq=vector()#
tListData=list()#
tListCorr=list()#
for(i in 1:2000)#
{#
	d <- data.frame(x1=rnorm(10),#
                 x2=rnorm(10),#
                 x3=rnorm(10),#
                 x4=rnorm(10),#
                 x5=rnorm(10))#
    tLM=lm(x1~x2+x3+x4+x5,data=d)#
    tS=summary(tLM)#
    tListRsq[i]=tS$r.squared#
    tListData[[i]]=d#
    tListCorr[[i]]=cor(d)#
}#
t_index=get_threshold_r_square(tListRsq,.8)#
t_m=mvrnorm(n = 2000,c(0,0,0,0,0), tListCorr[[t_index]])
setwd('/Users/peterstafford/generalassembly/capstone_repo/capstone/capstone')#
library(MASS)#
require(MASS)#
library(mice)#
#
skew_left=function(t_data,tConstant)#
{#
	tD=tanh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
skew_right=function(t_data,tConstant)#
{#
	tD=sinh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
convert_counts=function(t_data,t_factor,t_skew_left,t_skew)#
{#
	t_new_data=0;#
	if(t_skew_left==1)#
	{#
	 	t_new_data=skew_left(t_data,t_skew)#
	}#
	else #
	{#
	 	t_new_data=skew_right(t_data,t_skew)#
	}  #
	#tD=t_data/max(abs(t_data))#
	#tD=tD+2#
	tD=t_new_data#
	tD=tD*t_factor#
	tD=round(tD)#
	return (tD)#
}#
ampute_data<-function(tData,tCols,tProb)#
{#
	 tLen=length(tData[,1])#
	 tAmpData=tData#
	 tCount=round(tLen*tProb)#
	 for(i in tCols)#
	 {#
	 	 t_rows_set_null=sample(c(1:tLen),tCount, replace = FALSE)#
	 	 tAmpData[t_rows_set_null,i]<- NA #
	 }#
	 tR=list()#
	 tR[[1]]=tAmpData#
	 tR[[2]]=tData#
	 names(tR)=c("amp","data")#
	 return (tR)#
}#
get_threshold_r_square<-function(tData,t_thresh)#
{#
	t_indexes=which(tData<t_thresh)#
	t_vct1=tData[t_indexes]#
	tSrt=sort(tData,index.return=TRUE,decreasing=T)#
	t_max_index=tSrt.ix[1]#
	t_max=tSrt.x[t_max_index]#
	return (t_max)#
}#
plot_dist=function(t_actual,t_imputed,t_imputed_indexes)#
{#
	t_cols=c('col_1','col_2','col_3','col_4','col_5')#
	par(mfrow=c(4,2))#
    for(i in 2:5)#
    {#
    	hist(t_imputed[t_imputed_indexes,i],xlab=t_cols[i],main='Imputed')#
        hist(t_actual[,i],xlab=t_cols[i],main='Actual')#
    }	 #
}#
#
d <- data.frame(x1=rnorm(10),#
                 x2=rnorm(10),#
                 x3=rnorm(10),#
                 x4=rnorm(10),#
                 x5=rnorm(10))#
#cor(d) #
tLM=lm(x1~x2+x3+x4+x5,data=d)#
tS=summary(tLM)#
tN=names(tS)#
tListRsq=vector()#
tListData=list()#
tListCorr=list()#
for(i in 1:2000)#
{#
	d <- data.frame(x1=rnorm(10),#
                 x2=rnorm(10),#
                 x3=rnorm(10),#
                 x4=rnorm(10),#
                 x5=rnorm(10))#
    tLM=lm(x1~x2+x3+x4+x5,data=d)#
    tS=summary(tLM)#
    tListRsq[i]=tS$r.squared#
    tListData[[i]]=d#
    tListCorr[[i]]=cor(d)#
}#
t_index=get_threshold_r_square(tListRsq,.8)#
t_m=mvrnorm(n = 2000,c(0,0,0,0,0), tListCorr[[t_index]])#
t_data=data.frame(t_m)#
tLM=lm(x1~skew_right(x2,3)+x3+skew_left(x4,2)+convert_counts(x5,20,0,5),data=t_data)#
summary(tLM)#
tD=data.frame(t_data$x1,skew_right(t_data$x2,3),skew_left(t_data$x3,2),t_data$x4,convert_counts(t_data$x5,40,0,5))#
names(tD)=c('x1','x2','x3','x4','x5')#
amp_dt=ampute_data(tD,c(2,3,4,5),.3)#
mi <- mice(amp_dt$amp)#
train <- complete(mi)#
names(train)=c('x1','x2','x3','x4','x5')#
tLM=lm(x1~x2+x3+x4+x5,data=train)#
summary(tLM)#
t_imputed_indexes=which(is.na(amp_dt$amp$x4))#
plot_dist(amp_dt$data,train,t_imputed_indexes)#
write.csv(amp_dt$amp,file='amp_data.csv',row.names=FALSE)#
write.csv(tD,file='sim_data.csv',row.names=FALSE)#
write.csv(train,file='imputed_r_30_percent_data.csv',row.names=FALSE)
setwd('/Users/peterstafford/generalassembly/capstone_repo/capstone/capstone')#
library(MASS)#
require(MASS)#
library(mice)#
#
skew_left=function(t_data,tConstant)#
{#
	tD=tanh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
skew_right=function(t_data,tConstant)#
{#
	tD=sinh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
convert_counts=function(t_data,t_factor,t_skew_left,t_skew)#
{#
	t_new_data=0;#
	if(t_skew_left==1)#
	{#
	 	t_new_data=skew_left(t_data,t_skew)#
	}#
	else #
	{#
	 	t_new_data=skew_right(t_data,t_skew)#
	}  #
	#tD=t_data/max(abs(t_data))#
	#tD=tD+2#
	tD=t_new_data#
	tD=tD*t_factor#
	tD=round(tD)#
	return (tD)#
}#
ampute_data<-function(tData,tCols,tProb)#
{#
	 tLen=length(tData[,1])#
	 tAmpData=tData#
	 tCount=round(tLen*tProb)#
	 for(i in tCols)#
	 {#
	 	 t_rows_set_null=sample(c(1:tLen),tCount, replace = FALSE)#
	 	 tAmpData[t_rows_set_null,i]<- NA #
	 }#
	 tR=list()#
	 tR[[1]]=tAmpData#
	 tR[[2]]=tData#
	 names(tR)=c("amp","data")#
	 return (tR)#
}#
get_threshold_r_square<-function(tData,t_thresh)#
{#
	t_indexes=which(tData<t_thresh)#
	t_vct1=tData[t_indexes]#
	tSrt=sort(tData,index.return=TRUE,decreasing=T)#
	t_max_index=tSrt.ix[1]#
	t_max=tSrt.x[t_max_index]#
	return (t_max)#
}#
plot_dist=function(t_actual,t_imputed,t_imputed_indexes)#
{#
	t_cols=c('col_1','col_2','col_3','col_4','col_5')#
	par(mfrow=c(4,2))#
    for(i in 2:5)#
    {#
    	hist(t_imputed[t_imputed_indexes,i],xlab=t_cols[i],main='Imputed')#
        hist(t_actual[,i],xlab=t_cols[i],main='Actual')#
    }	 #
}#
#
d <- data.frame(x1=rnorm(10),#
                 x2=rnorm(10),#
                 x3=rnorm(10),#
                 x4=rnorm(10),#
                 x5=rnorm(10))
tLM=lm(x1~x2+x3+x4+x5,data=d)#
tS=summary(tLM)#
tN=names(tS)#
tListRsq=vector()#
tListData=list()#
tListCorr=list()
for(i in 1:2000)#
{#
	d <- data.frame(x1=rnorm(10),#
                 x2=rnorm(10),#
                 x3=rnorm(10),#
                 x4=rnorm(10),#
                 x5=rnorm(10))#
    tLM=lm(x1~x2+x3+x4+x5,data=d)#
    tS=summary(tLM)#
    tListRsq[i]=tS$r.squared#
    tListData[[i]]=d#
    tListCorr[[i]]=cor(d)#
}
t_index=get_threshold_r_square(tListRsq,.8)
setwd('/Users/peterstafford/generalassembly/capstone_repo/capstone/capstone')#
library(MASS)#
require(MASS)#
library(mice)#
#
skew_left=function(t_data,tConstant)#
{#
	tD=tanh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
skew_right=function(t_data,tConstant)#
{#
	tD=sinh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
convert_counts=function(t_data,t_factor,t_skew_left,t_skew)#
{#
	t_new_data=0;#
	if(t_skew_left==1)#
	{#
	 	t_new_data=skew_left(t_data,t_skew)#
	}#
	else #
	{#
	 	t_new_data=skew_right(t_data,t_skew)#
	}  #
	#tD=t_data/max(abs(t_data))#
	#tD=tD+2#
	tD=t_new_data#
	tD=tD*t_factor#
	tD=round(tD)#
	return (tD)#
}#
ampute_data<-function(tData,tCols,tProb)#
{#
	 tLen=length(tData[,1])#
	 tAmpData=tData#
	 tCount=round(tLen*tProb)#
	 for(i in tCols)#
	 {#
	 	 t_rows_set_null=sample(c(1:tLen),tCount, replace = FALSE)#
	 	 tAmpData[t_rows_set_null,i]<- NA #
	 }#
	 tR=list()#
	 tR[[1]]=tAmpData#
	 tR[[2]]=tData#
	 names(tR)=c("amp","data")#
	 return (tR)#
}#
get_threshold_r_square<-function(tData,t_thresh)#
{#
	t_indexes=which(tData<t_thresh)#
	t_vct1=tData[t_indexes]#
	tSrt=sort(tData,index.return=TRUE,decreasing=T)#
	t_max_index=tSrt$ix[1]#
	t_max=tSrt$x[t_max_index]#
	return (t_max)#
}#
plot_dist=function(t_actual,t_imputed,t_imputed_indexes)#
{#
	t_cols=c('col_1','col_2','col_3','col_4','col_5')#
	par(mfrow=c(4,2))#
    for(i in 2:5)#
    {#
    	hist(t_imputed[t_imputed_indexes,i],xlab=t_cols[i],main='Imputed')#
        hist(t_actual[,i],xlab=t_cols[i],main='Actual')#
    }	 #
}#
#
d <- data.frame(x1=rnorm(10),#
                 x2=rnorm(10),#
                 x3=rnorm(10),#
                 x4=rnorm(10),#
                 x5=rnorm(10))#
#cor(d) #
tLM=lm(x1~x2+x3+x4+x5,data=d)#
tS=summary(tLM)#
tN=names(tS)#
tListRsq=vector()#
tListData=list()#
tListCorr=list()#
for(i in 1:2000)#
{#
	d <- data.frame(x1=rnorm(10),#
                 x2=rnorm(10),#
                 x3=rnorm(10),#
                 x4=rnorm(10),#
                 x5=rnorm(10))#
    tLM=lm(x1~x2+x3+x4+x5,data=d)#
    tS=summary(tLM)#
    tListRsq[i]=tS$r.squared#
    tListData[[i]]=d#
    tListCorr[[i]]=cor(d)#
}#
t_index=get_threshold_r_square(tListRsq,.8)#
t_m=mvrnorm(n = 2000,c(0,0,0,0,0), tListCorr[[t_index]])#
t_data=data.frame(t_m)#
tLM=lm(x1~skew_right(x2,3)+x3+skew_left(x4,2)+convert_counts(x5,20,0,5),data=t_data)#
summary(tLM)#
tD=data.frame(t_data$x1,skew_right(t_data$x2,3),skew_left(t_data$x3,2),t_data$x4,convert_counts(t_data$x5,40,0,5))#
names(tD)=c('x1','x2','x3','x4','x5')#
amp_dt=ampute_data(tD,c(2,3,4,5),.3)#
mi <- mice(amp_dt$amp)#
train <- complete(mi)#
names(train)=c('x1','x2','x3','x4','x5')#
tLM=lm(x1~x2+x3+x4+x5,data=train)#
summary(tLM)#
t_imputed_indexes=which(is.na(amp_dt$amp$x4))#
plot_dist(amp_dt$data,train,t_imputed_indexes)#
write.csv(amp_dt$amp,file='amp_data.csv',row.names=FALSE)#
write.csv(tD,file='sim_data.csv',row.names=FALSE)#
write.csv(train,file='imputed_r_30_percent_data.csv',row.names=FALSE)
setwd('/Users/peterstafford/generalassembly/capstone_repo/capstone/capstone')#
library(MASS)#
require(MASS)#
library(mice)#
#
skew_left=function(t_data,tConstant)#
{#
	tD=tanh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
skew_right=function(t_data,tConstant)#
{#
	tD=sinh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
convert_counts=function(t_data,t_factor,t_skew_left,t_skew)#
{#
	t_new_data=0;#
	if(t_skew_left==1)#
	{#
	 	t_new_data=skew_left(t_data,t_skew)#
	}#
	else #
	{#
	 	t_new_data=skew_right(t_data,t_skew)#
	}  #
	#tD=t_data/max(abs(t_data))#
	#tD=tD+2#
	tD=t_new_data#
	tD=tD*t_factor#
	tD=round(tD)#
	return (tD)#
}#
ampute_data<-function(tData,tCols,tProb)#
{#
	 tLen=length(tData[,1])#
	 tAmpData=tData#
	 tCount=round(tLen*tProb)#
	 for(i in tCols)#
	 {#
	 	 t_rows_set_null=sample(c(1:tLen),tCount, replace = FALSE)#
	 	 tAmpData[t_rows_set_null,i]<- NA #
	 }#
	 tR=list()#
	 tR[[1]]=tAmpData#
	 tR[[2]]=tData#
	 names(tR)=c("amp","data")#
	 return (tR)#
}#
get_threshold_r_square<-function(tData,t_thresh)#
{#
	t_indexes=which(tData<t_thresh)#
	t_vct1=tData[t_indexes]#
	tSrt=sort(tData,index.return=TRUE,decreasing=T)#
	t_max_index=tSrt$ix[1]#
	t_max=tSrt$x[t_max_index]#
	return (t_max)#
}#
plot_dist=function(t_actual,t_imputed,t_imputed_indexes)#
{#
	t_cols=c('col_1','col_2','col_3','col_4','col_5')#
	par(mfrow=c(4,2))#
    for(i in 2:5)#
    {#
    	hist(t_imputed[t_imputed_indexes,i],xlab=t_cols[i],main='Imputed')#
        hist(t_actual[,i],xlab=t_cols[i],main='Actual')#
    }	 #
}#
#
d <- data.frame(x1=rnorm(10),#
                 x2=rnorm(10),#
                 x3=rnorm(10),#
                 x4=rnorm(10),#
                 x5=rnorm(10))#
#cor(d) #
tLM=lm(x1~x2+x3+x4+x5,data=d)#
tS=summary(tLM)#
tN=names(tS)#
tListRsq=vector()#
tListData=list()#
tListCorr=list()#
for(i in 1:2000)#
{#
	d <- data.frame(x1=rnorm(10),#
                 x2=rnorm(10),#
                 x3=rnorm(10),#
                 x4=rnorm(10),#
                 x5=rnorm(10))#
    tLM=lm(x1~x2+x3+x4+x5,data=d)#
    tS=summary(tLM)#
    tListRsq[i]=tS$r.squared#
    tListData[[i]]=d#
    tListCorr[[i]]=cor(d)#
}#
t_index=get_threshold_r_square(tListRsq,.8)#
t_m=mvrnorm(n = 2000,c(0,0,0,0,0), tListCorr[[t_index]])#
t_data=data.frame(t_m)#
tLM=lm(x1~skew_right(x2,3)+x3+skew_left(x4,2)+convert_counts(x5,20,0,5),data=t_data)#
summary(tLM)#
tD=data.frame(t_data$x1,skew_right(t_data$x2,3),skew_left(t_data$x3,2),t_data$x4,convert_counts(t_data$x5,40,0,5))#
names(tD)=c('x1','x2','x3','x4','x5')#
amp_dt=ampute_data(tD,c(2,3,4,5),.6)#
mi <- mice(amp_dt$amp)#
train <- complete(mi)#
names(train)=c('x1','x2','x3','x4','x5')#
tLM=lm(x1~x2+x3+x4+x5,data=train)#
summary(tLM)#
t_imputed_indexes=which(is.na(amp_dt$amp$x4))#
plot_dist(amp_dt$data,train,t_imputed_indexes)#
write.csv(amp_dt$amp,file='amp_data.csv',row.names=FALSE)#
write.csv(tD,file='sim_data.csv',row.names=FALSE)#
write.csv(train,file='imputed_r_60_percent_data.csv',row.names=FALSE)#
#par(mfrow=c(4,2))#
#hist(train$x4[t_na_indexes],xlab='col_4',main='Imputed')#
#hist(tD$x4,xlab='col_4',main='Actual')
setwd('/Users/peterstafford/generalassembly/capstone_repo/capstone/capstone')#
library(MASS)#
require(MASS)#
library(mice)#
#
skew_left=function(t_data,tConstant)#
{#
	tD=tanh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
skew_right=function(t_data,tConstant)#
{#
	tD=sinh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
convert_counts=function(t_data,t_factor,t_skew_left,t_skew)#
{#
	t_new_data=0;#
	if(t_skew_left==1)#
	{#
	 	t_new_data=skew_left(t_data,t_skew)#
	}#
	else #
	{#
	 	t_new_data=skew_right(t_data,t_skew)#
	}  #
	#tD=t_data/max(abs(t_data))#
	#tD=tD+2#
	tD=t_new_data#
	tD=tD*t_factor#
	tD=round(tD)#
	return (tD)#
}#
ampute_data<-function(tData,tCols,tProb)#
{#
	 tLen=length(tData[,1])#
	 tAmpData=tData#
	 tCount=round(tLen*tProb)#
	 for(i in tCols)#
	 {#
	 	 t_rows_set_null=sample(c(1:tLen),tCount, replace = FALSE)#
	 	 tAmpData[t_rows_set_null,i]<- NA #
	 }#
	 tR=list()#
	 tR[[1]]=tAmpData#
	 tR[[2]]=tData#
	 names(tR)=c("amp","data")#
	 return (tR)#
}#
get_threshold_r_square<-function(tData,t_thresh)#
{#
	t_indexes=which(tData<t_thresh)#
	t_vct1=tData[t_indexes]#
	tSrt=sort(tData,index.return=TRUE,decreasing=T)#
	t_max_index=tSrt$ix[1]#
	t_max=tSrt$x[t_max_index]#
	return (t_max)#
}#
plot_dist=function(t_actual,t_imputed,t_imputed_indexes)#
{#
	t_cols=c('col_1','col_2','col_3','col_4','col_5')#
	par(mfrow=c(4,2))#
    for(i in 2:5)#
    {#
    	hist(t_imputed[t_imputed_indexes,i],xlab=t_cols[i],main='Imputed')#
        hist(t_actual[,i],xlab=t_cols[i],main='Actual')#
    }	 #
}#
#
d <- data.frame(x1=rnorm(10),#
                 x2=rnorm(10),#
                 x3=rnorm(10),#
                 x4=rnorm(10),#
                 x5=rnorm(10))#
#cor(d) #
tLM=lm(x1~x2+x3+x4+x5,data=d)#
tS=summary(tLM)#
tN=names(tS)#
tListRsq=vector()#
tListData=list()#
tListCorr=list()#
for(i in 1:2000)#
{#
	d <- data.frame(x1=rnorm(10),#
                 x2=rnorm(10),#
                 x3=rnorm(10),#
                 x4=rnorm(10),#
                 x5=rnorm(10))#
    tLM=lm(x1~x2+x3+x4+x5,data=d)#
    tS=summary(tLM)#
    tListRsq[i]=tS$r.squared#
    tListData[[i]]=d#
    tListCorr[[i]]=cor(d)#
}#
t_index=get_threshold_r_square(tListRsq,.8)#
t_m=mvrnorm(n = 2000,c(0,0,0,0,0), tListCorr[[t_index]])#
t_data=data.frame(t_m)#
tLM=lm(x1~skew_right(x2,3)+x3+skew_left(x4,2)+convert_counts(x5,20,0,5),data=t_data)#
summary(tLM)#
tD=data.frame(t_data$x1,skew_right(t_data$x2,3),skew_left(t_data$x3,2),t_data$x4,convert_counts(t_data$x5,40,0,5))#
names(tD)=c('x1','x2','x3','x4','x5')#
amp_dt=ampute_data(tD,c(2,3,4,5),.6)#
mi <- mice(amp_dt$amp)#
train <- complete(mi)#
names(train)=c('x1','x2','x3','x4','x5')#
tLM=lm(x1~x2+x3+x4+x5,data=train)#
summary(tLM)#
t_imputed_indexes=which(is.na(amp_dt$amp$x4))#
plot_dist(amp_dt$data,train,t_imputed_indexes)#
write.csv(amp_dt$amp,file='amp_data.csv',row.names=FALSE)#
write.csv(tD,file='sim_data.csv',row.names=FALSE)#
write.csv(train,file='imputed_r_50_percent_data.csv',row.names=FALSE)#
#par(mfrow=c(4,2))#
#hist(train$x4[t_na_indexes],xlab='col_4',main='Imputed')#
#hist(tD$x4,xlab='col_4',main='Actual')
setwd('/Users/peterstafford/generalassembly/capstone_repo/capstone/capstone')#
library(MASS)#
require(MASS)#
library(mice)#
#
skew_left=function(t_data,tConstant)#
{#
	tD=tanh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
skew_right=function(t_data,tConstant)#
{#
	tD=sinh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
convert_counts=function(t_data,t_factor,t_skew_left,t_skew)#
{#
	t_new_data=0;#
	if(t_skew_left==1)#
	{#
	 	t_new_data=skew_left(t_data,t_skew)#
	}#
	else #
	{#
	 	t_new_data=skew_right(t_data,t_skew)#
	}  #
	#tD=t_data/max(abs(t_data))#
	#tD=tD+2#
	tD=t_new_data#
	tD=tD*t_factor#
	tD=round(tD)#
	return (tD)#
}#
ampute_data<-function(tData,tCols,tProb)#
{#
	 tLen=length(tData[,1])#
	 tAmpData=tData#
	 tCount=round(tLen*tProb)#
	 for(i in tCols)#
	 {#
	 	 t_rows_set_null=sample(c(1:tLen),tCount, replace = FALSE)#
	 	 tAmpData[t_rows_set_null,i]<- NA #
	 }#
	 tR=list()#
	 tR[[1]]=tAmpData#
	 tR[[2]]=tData#
	 names(tR)=c("amp","data")#
	 return (tR)#
}#
get_threshold_r_square<-function(tData,t_thresh)#
{#
	t_indexes=which(tData<t_thresh)#
	t_vct1=tData[t_indexes]#
	tSrt=sort(tData,index.return=TRUE,decreasing=T)#
	t_max_index=tSrt$ix[1]#
	t_max=tSrt$x[t_max_index]#
	return (t_max)#
}#
plot_dist=function(t_actual,t_imputed,t_imputed_indexes)#
{#
	t_cols=c('col_1','col_2','col_3','col_4','col_5')#
	par(mfrow=c(4,2))#
    for(i in 2:5)#
    {#
    	hist(t_imputed[t_imputed_indexes,i],xlab=t_cols[i],main='Imputed')#
        hist(t_actual[,i],xlab=t_cols[i],main='Actual')#
    }	 #
}#
#
d <- data.frame(x1=rnorm(10),#
                 x2=rnorm(10),#
                 x3=rnorm(10),#
                 x4=rnorm(10),#
                 x5=rnorm(10))#
#cor(d) #
tLM=lm(x1~x2+x3+x4+x5,data=d)#
tS=summary(tLM)#
tN=names(tS)#
tListRsq=vector()#
tListData=list()#
tListCorr=list()#
for(i in 1:2000)#
{#
	d <- data.frame(x1=rnorm(10),#
                 x2=rnorm(10),#
                 x3=rnorm(10),#
                 x4=rnorm(10),#
                 x5=rnorm(10))#
    tLM=lm(x1~x2+x3+x4+x5,data=d)#
    tS=summary(tLM)#
    tListRsq[i]=tS$r.squared#
    tListData[[i]]=d#
    tListCorr[[i]]=cor(d)#
}#
t_index=get_threshold_r_square(tListRsq,.8)#
t_m=mvrnorm(n = 2000,c(0,0,0,0,0), tListCorr[[t_index]])#
t_data=data.frame(t_m)#
tLM=lm(x1~skew_right(x2,3)+x3+skew_left(x4,2)+convert_counts(x5,20,0,5),data=t_data)#
summary(tLM)#
tD=data.frame(t_data$x1,skew_right(t_data$x2,3),skew_left(t_data$x3,2),t_data$x4,convert_counts(t_data$x5,40,0,5))#
names(tD)=c('x1','x2','x3','x4','x5')#
amp_dt=ampute_data(tD,c(2,3,4,5),.5)#
mi <- mice(amp_dt$amp)#
train <- complete(mi)#
names(train)=c('x1','x2','x3','x4','x5')#
tLM=lm(x1~x2+x3+x4+x5,data=train)#
summary(tLM)#
t_imputed_indexes=which(is.na(amp_dt$amp$x4))#
plot_dist(amp_dt$data,train,t_imputed_indexes)#
write.csv(amp_dt$amp,file='amp_data.csv',row.names=FALSE)#
write.csv(tD,file='sim_data.csv',row.names=FALSE)#
write.csv(train,file='imputed_r_50_percent_data.csv',row.names=FALSE)
setwd('/Users/peterstafford/generalassembly/capstone_repo/capstone/capstone')#
library(MASS)#
require(MASS)#
library(mice)#
#
skew_left=function(t_data,tConstant)#
{#
	tD=tanh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
skew_right=function(t_data,tConstant)#
{#
	tD=sinh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
convert_counts=function(t_data,t_factor,t_skew_left,t_skew)#
{#
	t_new_data=0;#
	if(t_skew_left==1)#
	{#
	 	t_new_data=skew_left(t_data,t_skew)#
	}#
	else #
	{#
	 	t_new_data=skew_right(t_data,t_skew)#
	}  #
	#tD=t_data/max(abs(t_data))#
	#tD=tD+2#
	tD=t_new_data#
	tD=tD*t_factor#
	tD=round(tD)#
	return (tD)#
}#
ampute_data<-function(tData,tCols,tProb)#
{#
	 tLen=length(tData[,1])#
	 tAmpData=tData#
	 tCount=round(tLen*tProb)#
	 for(i in tCols)#
	 {#
	 	 t_rows_set_null=sample(c(1:tLen),tCount, replace = FALSE)#
	 	 tAmpData[t_rows_set_null,i]<- NA #
	 }#
	 tR=list()#
	 tR[[1]]=tAmpData#
	 tR[[2]]=tData#
	 names(tR)=c("amp","data")#
	 return (tR)#
}#
get_threshold_r_square<-function(tData,t_thresh)#
{#
	t_indexes=which(tData<t_thresh)#
	t_vct1=tData[t_indexes]#
	tSrt=sort(tData,index.return=TRUE,decreasing=T)#
	t_max_index=tSrt$ix[1]#
	t_max=tSrt$x[t_max_index]#
	return (t_max)#
}#
plot_dist=function(t_actual,t_imputed,t_imputed_indexes)#
{#
	t_cols=c('col_1','col_2','col_3','col_4','col_5')#
	par(mfrow=c(4,2))#
    for(i in 2:5)#
    {#
    	hist(t_imputed[t_imputed_indexes,i],xlab=t_cols[i],main='Imputed')#
        hist(t_actual[,i],xlab=t_cols[i],main='Actual')#
    }	 #
}#
#
d <- data.frame(x1=rnorm(10),#
                 x2=rnorm(10),#
                 x3=rnorm(10),#
                 x4=rnorm(10),#
                 x5=rnorm(10))#
#cor(d) #
tLM=lm(x1~x2+x3+x4+x5,data=d)#
tS=summary(tLM)#
tN=names(tS)#
tListRsq=vector()#
tListData=list()#
tListCorr=list()#
for(i in 1:2000)#
{#
	d <- data.frame(x1=rnorm(10),#
                 x2=rnorm(10),#
                 x3=rnorm(10),#
                 x4=rnorm(10),#
                 x5=rnorm(10))#
    tLM=lm(x1~x2+x3+x4+x5,data=d)#
    tS=summary(tLM)#
    tListRsq[i]=tS$r.squared#
    tListData[[i]]=d#
    tListCorr[[i]]=cor(d)#
}#
t_index=get_threshold_r_square(tListRsq,.8)#
t_m=mvrnorm(n = 2000,c(0,0,0,0,0), tListCorr[[t_index]])#
t_data=data.frame(t_m)#
tLM=lm(x1~skew_right(x2,3)+x3+skew_left(x4,2)+convert_counts(x5,20,0,5),data=t_data)#
summary(tLM)#
tD=data.frame(t_data$x1,skew_right(t_data$x2,3),skew_left(t_data$x3,2),t_data$x4,convert_counts(t_data$x5,40,0,5))#
names(tD)=c('x1','x2','x3','x4','x5')#
amp_dt=ampute_data(tD,c(2,3,4,5),.3)#
mi <- mice(amp_dt$amp)#
train <- complete(mi)#
names(train)=c('x1','x2','x3','x4','x5')#
tLM=lm(x1~x2+x3+x4+x5,data=train)#
summary(tLM)#
t_imputed_indexes=which(is.na(amp_dt$amp$x4))#
plot_dist(amp_dt$data,train,t_imputed_indexes)#
write.csv(amp_dt$amp,file='amp_data.csv',row.names=FALSE)#
write.csv(tD,file='sim_data.csv',row.names=FALSE)#
write.csv(train,file='imputed_r_30_percent_data.csv',row.names=FALSE)
setwd('/Users/peterstafford/generalassembly/capstone_repo/capstone/capstone')#
library(MASS)#
require(MASS)#
library(mice)#
#
skew_left=function(t_data,tConstant)#
{#
	tD=tanh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
skew_right=function(t_data,tConstant)#
{#
	tD=sinh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
convert_counts=function(t_data,t_factor,t_skew_left,t_skew)#
{#
	t_new_data=0;#
	if(t_skew_left==1)#
	{#
	 	t_new_data=skew_left(t_data,t_skew)#
	}#
	else #
	{#
	 	t_new_data=skew_right(t_data,t_skew)#
	}  #
	#tD=t_data/max(abs(t_data))#
	#tD=tD+2#
	tD=t_new_data#
	tD=tD*t_factor#
	tD=round(tD)#
	return (tD)#
}#
ampute_data<-function(tData,tCols,tProb)#
{#
	 tLen=length(tData[,1])#
	 tAmpData=tData#
	 tCount=round(tLen*tProb)#
	 for(i in tCols)#
	 {#
	 	 t_rows_set_null=sample(c(1:tLen),tCount, replace = FALSE)#
	 	 tAmpData[t_rows_set_null,i]<- NA #
	 }#
	 tR=list()#
	 tR[[1]]=tAmpData#
	 tR[[2]]=tData#
	 names(tR)=c("amp","data")#
	 return (tR)#
}#
get_threshold_r_square<-function(tData,t_thresh)#
{#
	t_indexes=which(tData<t_thresh)#
	t_vct1=tData[t_indexes]#
	tSrt=sort(tData,index.return=TRUE,decreasing=T)#
	t_max_index=tSrt$ix[1]#
	t_max=tSrt$x[t_max_index]#
	return (t_max)#
}#
plot_dist=function(t_actual,t_imputed,t_imputed_indexes)#
{#
	t_cols=c('col_1','col_2','col_3','col_4','col_5')#
	par(mfrow=c(4,2))#
    for(i in 2:5)#
    {#
    	hist(t_imputed[t_imputed_indexes,i],xlab=t_cols[i],main='Imputed')#
        hist(t_actual[,i],xlab=t_cols[i],main='Actual')#
    }	 #
}#
#
d <- data.frame(x1=rnorm(10),#
                 x2=rnorm(10),#
                 x3=rnorm(10),#
                 x4=rnorm(10),#
                 x5=rnorm(10))#
#cor(d) #
tLM=lm(x1~x2+x3+x4+x5,data=d)#
tS=summary(tLM)#
tN=names(tS)#
tListRsq=vector()#
tListData=list()#
tListCorr=list()#
for(i in 1:2000)#
{#
	d <- data.frame(x1=rnorm(10),#
                 x2=rnorm(10),#
                 x3=rnorm(10),#
                 x4=rnorm(10),#
                 x5=rnorm(10))#
    tLM=lm(x1~x2+x3+x4+x5,data=d)#
    tS=summary(tLM)#
    tListRsq[i]=tS$r.squared#
    tListData[[i]]=d#
    tListCorr[[i]]=cor(d)#
}#
t_index=get_threshold_r_square(tListRsq,.9)#
t_m=mvrnorm(n = 2000,c(0,0,0,0,0), tListCorr[[t_index]])#
t_data=data.frame(t_m)#
tLM=lm(x1~skew_right(x2,3)+x3+skew_left(x4,2)+convert_counts(x5,20,0,5),data=t_data)#
summary(tLM)#
tD=data.frame(t_data$x1,skew_right(t_data$x2,3),skew_left(t_data$x3,2),t_data$x4,convert_counts(t_data$x5,40,0,5))#
names(tD)=c('x1','x2','x3','x4','x5')#
amp_dt=ampute_data(tD,c(2,3,4,5),.3)#
mi <- mice(amp_dt$amp)#
train <- complete(mi)#
names(train)=c('x1','x2','x3','x4','x5')#
tLM=lm(x1~x2+x3+x4+x5,data=train)#
summary(tLM)#
t_imputed_indexes=which(is.na(amp_dt$amp$x4))#
plot_dist(amp_dt$data,train,t_imputed_indexes)#
write.csv(amp_dt$amp,file='amp_data.csv',row.names=FALSE)#
write.csv(tD,file='sim_data.csv',row.names=FALSE)#
write.csv(train,file='imputed_r_30_percent_data.csv',row.names=FALSE)
setwd('/Users/peterstafford/generalassembly/capstone_repo/capstone/capstone')#
library(MASS)#
require(MASS)#
library(mice)#
#
skew_left=function(t_data,tConstant)#
{#
	tD=tanh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
skew_right=function(t_data,tConstant)#
{#
	tD=sinh(t_data/max(abs(t_data))+tConstant)#
	return (tD)#
}#
convert_counts=function(t_data,t_factor,t_skew_left,t_skew)#
{#
	t_new_data=0;#
	if(t_skew_left==1)#
	{#
	 	t_new_data=skew_left(t_data,t_skew)#
	}#
	else #
	{#
	 	t_new_data=skew_right(t_data,t_skew)#
	}  #
	#tD=t_data/max(abs(t_data))#
	#tD=tD+2#
	tD=t_new_data#
	tD=tD*t_factor#
	tD=round(tD)#
	return (tD)#
}#
ampute_data<-function(tData,tCols,tProb)#
{#
	 tLen=length(tData[,1])#
	 tAmpData=tData#
	 tCount=round(tLen*tProb)#
	 for(i in tCols)#
	 {#
	 	 t_rows_set_null=sample(c(1:tLen),tCount, replace = FALSE)#
	 	 tAmpData[t_rows_set_null,i]<- NA #
	 }#
	 tR=list()#
	 tR[[1]]=tAmpData#
	 tR[[2]]=tData#
	 names(tR)=c("amp","data")#
	 return (tR)#
}#
get_threshold_r_square<-function(tData,t_thresh)#
{#
	t_indexes=which(tData<t_thresh)#
	t_vct1=tData[t_indexes]#
	tSrt=sort(tData,index.return=TRUE,decreasing=T)#
	t_max_index=tSrt$ix[1]#
	t_max=tSrt$x[t_max_index]#
	return (t_max)#
}#
plot_dist=function(t_actual,t_imputed,t_imputed_indexes)#
{#
	t_cols=c('col_1','col_2','col_3','col_4','col_5')#
	par(mfrow=c(4,2))#
    for(i in 2:5)#
    {#
    	hist(t_imputed[t_imputed_indexes,i],xlab=t_cols[i],main='Imputed')#
        hist(t_actual[,i],xlab=t_cols[i],main='Actual')#
    }	 #
}#
#
d <- data.frame(x1=rnorm(10),#
                 x2=rnorm(10),#
                 x3=rnorm(10),#
                 x4=rnorm(10),#
                 x5=rnorm(10))#
#cor(d) #
tLM=lm(x1~x2+x3+x4+x5,data=d)#
tS=summary(tLM)#
tN=names(tS)#
tListRsq=vector()#
tListData=list()#
tListCorr=list()#
for(i in 1:2000)#
{#
	d <- data.frame(x1=rnorm(10),#
                 x2=rnorm(10),#
                 x3=rnorm(10),#
                 x4=rnorm(10),#
                 x5=rnorm(10))#
    tLM=lm(x1~x2+x3+x4+x5,data=d)#
    tS=summary(tLM)#
    tListRsq[i]=tS$r.squared#
    tListData[[i]]=d#
    tListCorr[[i]]=cor(d)#
}#
t_index=get_threshold_r_square(tListRsq,.9)#
t_m=mvrnorm(n = 2000,c(0,0,0,0,0), tListCorr[[t_index]])#
t_data=data.frame(t_m)#
tLM=lm(x1~skew_right(x2,3)+x3+skew_left(x4,2)+convert_counts(x5,20,0,5),data=t_data)#
summary(tLM)#
tD=data.frame(t_data$x1,skew_right(t_data$x2,3),skew_left(t_data$x3,2),t_data$x4,convert_counts(t_data$x5,40,0,5))#
names(tD)=c('x1','x2','x3','x4','x5')#
amp_dt=ampute_data(tD,c(2,3,4,5),.3)#
mi <- mice(amp_dt$amp)#
train <- complete(mi)#
names(train)=c('x1','x2','x3','x4','x5')#
tLM=lm(x1~x2+x3+x4+x5,data=train)#
summary(tLM)#
t_imputed_indexes=which(is.na(amp_dt$amp$x4))#
plot_dist(amp_dt$data,train,t_imputed_indexes)#
write.csv(amp_dt$amp,file='amp_data.csv',row.names=FALSE)#
write.csv(tD,file='sim_data.csv',row.names=FALSE)#
write.csv(train,file='imputed_r_30_percent_data.csv',row.names=FALSE)
